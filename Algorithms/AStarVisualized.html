<!DOCTYPE html>
<meta charset="UTF-8" />
<html>
  <head> </head>
  <body>
    <canvas id="canvas" width="2010px" height="1510px"></canvas>
  </body>
</html>

<script>
  const xLength = 20;
  const yLength = 15;
  const windowWidth = xLength * 100 + 10;
  const windowHeight = yLength * 100 + 10;
  const fieldScale = 90;

  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  ctx.width = windowWidth;
  ctx.height = windowHeight;
  const cRect = canvas.getBoundingClientRect();
  canvas.addEventListener('mousemove', onMouseMovement);
  canvas.onmouseup = onMouseClickUp;

  let oldFieldCoords; // for the hover animation
  let newWallFields = [];

  function drawMain(data = fieldInfos) {
    console.log('exec 1');
    // fields itself
    for (let y = 0; y < yLength; ++y)
      for (let x = 0; x < xLength; ++x) setField(x, y, data[y][x][0], false);

    drawGrid();
    drawGridAxes();
  }

  function drawField(x, y, size, color, text1, text2) {
    console.log('exec 2');

    // field pixel
    ctx.fillStyle = color;
    ctx.fillRect(x, y, size, size);

    // text
    ctx.font = '20px Georgia';
    ctx.fillStyle = '#000000';
    if (text1) {
      text1 = 'h: ' + text1;
      const fldShift = size / 2;
      const txtShift = text1.length * 3.5;
      ctx.fillText(text1, x + fldShift - txtShift, y + fldShift + 15);
    }
    if (text2) {
      text2 = 'g: ' + text2;
      const fldShift = size / 2;
      const txtShift = text2.length * 3.5;
      ctx.fillText(text2, x + fldShift - txtShift, y + fldShift - 15);
    }
  }

  function drawGrid() {
    // grid
    ctx.fillStyle = '#000000';
    // x grid
    for (let y = 0; y <= yLength; ++y)
      ctx.fillRect(
        fieldScale,
        y * fieldScale + fieldScale,
        fieldScale * xLength,
        fieldScale * 0.05
      );
    // y grid
    for (let x = 0; x <= xLength; ++x)
      ctx.fillRect(
        x * fieldScale + fieldScale,
        fieldScale,
        fieldScale * 0.05,
        yLength * fieldScale
      );
  }

  function drawGridAxes() {
    // coordinate system
    ctx.font = '20px Georgia';
    ctx.fillStyle = '#000000';
    for (let x = 0; x < xLength; ++x)
      ctx.fillText(
        x,
        x * fieldScale + fieldScale + fieldScale / 2 - x.toString().length * 2,
        fieldScale - 10
      );
    for (let y = 0; y < yLength; ++y)
      ctx.fillText(
        y,
        fieldScale - 20 - y.toString().length * 10,
        y * fieldScale + fieldScale + fieldScale / 2
      );
  }

  // for hover animation
  function drawFieldBorder(
    x,
    y,
    color = '#000000',
    size = 10,
    gridStyle = false
  ) {
    ctx.fillStyle = color;
    // upper line
    ctx.fillRect((x + 1) * fieldScale, (y + 1) * fieldScale, fieldScale, size);

    // left line
    ctx.fillRect((x + 1) * fieldScale, (y + 1) * fieldScale, size, fieldScale);

    // right line
    ctx.fillRect(
      (x + 1) * fieldScale + fieldScale - size / 2,
      (y + 1) * fieldScale,
      size,
      fieldScale
    );

    // bottom line
    ctx.fillRect(
      (x + 1) * fieldScale,
      (y + 1) * fieldScale + fieldScale - size / 2,
      fieldScale,
      size
    );
  }

  // hover animation
  function onMouseMovement(event) {
    const mouseX = Math.round(event.clientX - cRect.left);
    const mouseY = Math.round(event.clientY - cRect.top);
    const fieldCoords = {
      x: Math.floor(mouseX / fieldScale) - 1,
      y: Math.floor(mouseY / fieldScale) - 1
    };

    // check bounces
    if (
      fieldCoords.x < 0 ||
      fieldCoords.x >= xLength ||
      fieldCoords.y < 0 ||
      fieldCoords.y >= yLength
    )
      return;

    // check if it is a new field
    const isNewField =
      oldFieldCoords === undefined ||
      oldFieldCoords.x !== fieldCoords.x ||
      oldFieldCoords.y !== fieldCoords.y;
    if (!isNewField) return;

    // TODO, change field color on hover
    //setField(fieldCoords.x, fieldCoords.y, '#101010');

    // add a border to the current field
    drawFieldBorder(fieldCoords.x, fieldCoords.y);

    // reset the last field border
    if (oldFieldCoords !== undefined) {
      // TODO
      let _color = fieldInfos[oldFieldCoords.y][oldFieldCoords.x][0];
      if (
        newWallFields.some(
          (w) => w.x === oldFieldCoords.x && w.y === oldFieldCoords.y
        )
      )
        _color = '#808080';
      setField(oldFieldCoords.x, oldFieldCoords.y, _color);
    }

    oldFieldCoords = fieldCoords;
  }

  // add/remove walls
  function onMouseClickUp(event) {
    const mouseX = Math.round(event.clientX - cRect.left);
    const mouseY = Math.round(event.clientY - cRect.top);
    const fieldCoords = {
      x: Math.floor(mouseX / fieldScale) - 1,
      y: Math.floor(mouseY / fieldScale) - 1
    };

    // check bounces
    if (
      fieldCoords.x < 0 ||
      fieldCoords.x >= xLength ||
      fieldCoords.y < 0 ||
      fieldCoords.y >= yLength
    )
      return;

    // check if already in list, if not add it to new walls
    const fieldIndex = newWallFields.findIndex(
      (w) => w.x === fieldCoords.x && w.y === fieldCoords.y
    );
    if (fieldIndex === -1) {
      // add field to wall array
      newWallFields.push({ x: fieldCoords.x, y: fieldCoords.y });

      // update color
      setField(fieldCoords.x, fieldCoords.y, '#808080');
      drawFieldBorder(fieldCoords.x, fieldCoords.y);
    } else {
      // remove from walls array
      newWallFields.splice(fieldIndex, 1);

      // reset color
      setField(fieldCoords.x, fieldCoords.y);
      drawFieldBorder(fieldCoords.x, fieldCoords.y);
    }

    console.clear();
    console.log(
      newWallFields
        .map((w) => `[{ x: ${w.x}, y: ${w.y} }, { x: w, y: -1 }]`)
        .toString()
    );
  }

  function setField(fieldX, fieldY, color, _drawGrid = true) {
    drawField(
      fieldX * fieldScale + fieldScale,
      fieldY * fieldScale + fieldScale,
      fieldScale,
      color === undefined ? fieldInfos[fieldY][fieldX][0] : color,
      fieldInfos[fieldY][fieldX][1],
      fieldInfos[fieldY][fieldX][2]
    );
    if (_drawGrid) drawGrid();
  }

  const fieldInfos = [
    [
      ['#0000ff', '17', '0'],
      ['#00ff00', '16.1', '1'],
      ['#00ff00', '15.3', '2'],
      ['#00ff00', '14.4', '3'],
      ['#00ffff', '13.6', '4'],
      ['#00ffff', '12.8', '5'],
      ['#00ffff', '12', '6'],
      ['#00ffff', '11.3', '7'],
      ['#ffff00', '10.6', '8'],
      ['#ffff00', '10', '9.8'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#00ffff', '16.6', '1'],
      ['#00ffff', '15.7', '1.4'],
      ['#00ffff', '14.8', '2.4'],
      ['#00ffff', '13.9', '3.4'],
      ['#00ff00', '13', '4.4'],
      ['#00ffff', '12.2', '5.4'],
      ['#00ffff', '11.4', '6.4'],
      ['#00ffff', '10.6', '7.4'],
      ['#00ffff', '9.9', '8.4'],
      ['#ffff00', '9.2', '9.4'],
      ['#ffff00', '8.6', '11.2'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#00ffff', '16.2', '2'],
      ['#00ffff', '15.2', '2.4'],
      ['#00ffff', '14.3', '2.8'],
      ['#00ffff', '13.4', '3.8'],
      ['#00ffff', '12.5', '4.8'],
      ['#00ff00', '11.7', '5.8'],
      ['#00ffff', '10.8', '6.8'],
      ['#00ffff', '10', '7.8'],
      ['#00ffff', '9.2', '8.8'],
      ['#00ffff', '8.5', '9.8'],
      ['#ffff00', '7.8', '10.8'],
      ['#ffff00', '7.2', '12.7'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffff00', '15.8', '3'],
      ['#00ffff', '14.9', '3.4'],
      ['#00ffff', '13.9', '3.8'],
      ['#00ffff', '13', '4.2'],
      ['#00ffff', '12.1', '5.2'],
      ['#00ffff', '11.2', '6.2'],
      ['#00ff00', '10.3', '7.2'],
      ['#00ff00', '9.4', '8.2'],
      ['#00ff00', '8.6', '9.2'],
      ['#00ffff', '7.8', '10.2'],
      ['#00ffff', '7.1', '11.2'],
      ['#ffff00', '6.4', '12.2'],
      ['#ffff00', '5.8', '14.1'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffff00', '15.5', '4.8'],
      ['#ffff00', '14.6', '4.4'],
      ['#ffff00', '13.6', '4.8'],
      ['#00ffff', '12.6', '5.2'],
      ['#00ffff', '11.7', '5.7'],
      ['#00ffff', '10.8', '6.7'],
      ['#00ffff', '9.8', '7.7'],
      ['#00ffff', '8.9', '8.7'],
      ['#00ffff', '8.1', '9.7'],
      ['#00ff00', '7.2', '10.7'],
      ['#00ffff', '6.4', '11.7'],
      ['#00ffff', '5.7', '12.7'],
      ['#808080', '-', '-'],
      ['#ffff00', '4.5', '15.5'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffff00', '13.3', '6.7'],
      ['#ffff00', '12.4', '6.2'],
      ['#00ffff', '11.4', '6.7'],
      ['#00ffff', '10.4', '7.1'],
      ['#00ffff', '9.5', '8.1'],
      ['#00ffff', '8.5', '9.1'],
      ['#00ffff', '7.6', '10.1'],
      ['#00ffff', '6.7', '11.1'],
      ['#00ff00', '5.8', '12.1'],
      ['#808080', '-', '-'],
      ['#00ffff', '4.2', '14.1'],
      ['#ffff00', '3.6', '15.1'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffff00', '12.2', '8.1'],
      ['#ffff00', '11.2', '7.7'],
      ['#00ffff', '10.2', '8.1'],
      ['#00ffff', '9.2', '8.5'],
      ['#00ffff', '8.2', '9.5'],
      ['#00ffff', '7.3', '10.5'],
      ['#00ffff', '6.3', '11.5'],
      ['#808080', '-', '-'],
      ['#00ff00', '4.5', '13.5'],
      ['#00ff00', '3.6', '14.5'],
      ['#ffff00', '2.8', '15.5'],
      ['#ffff00', '2.2', '17.3'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffff00', '11', '9.5'],
      ['#ffff00', '10', '9.1'],
      ['#ffff00', '9.1', '9.5'],
      ['#00ffff', '8.1', '9.9'],
      ['#00ffff', '7.1', '10.9'],
      ['#00ffff', '6.1', '11.9'],
      ['#00ffff', '5.1', '12.9'],
      ['#00ffff', '4.1', '13.9'],
      ['#00ffff', '3.2', '14.9'],
      ['#00ff00', '2.2', '15.9'],
      ['#ffff00', '1.4', '16.9'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffff00', '9', '11.3'],
      ['#ffff00', '8', '10.9'],
      ['#ffff00', '7', '11.3'],
      ['#ffff00', '6', '12.3'],
      ['#ffff00', '5', '13.3'],
      ['#ffff00', '4', '14.3'],
      ['#ffff00', '3', '15.3'],
      ['#ffff00', '2', '16.3'],
      ['#00ff00', '1', '17.3'],
      ['#ff0000', '-', '18.3'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ],
    [
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-'],
      ['#ffffff', '-', '-']
    ]
  ];

  drawMain();
  //by Elias Cuin
</script>

<style>
  #canvas {
    background-color: rgb(36, 72, 72);

    image-rendering: -moz-crisp-edges;
    image-rendering: -webkit-crisp-edges;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
  }
</style>
